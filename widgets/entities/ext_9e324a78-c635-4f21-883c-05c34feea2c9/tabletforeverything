{"__id":"c6345397-c32f-4df2-a61f-2b8ca55f5e5b","namespace":"ext_9e324a78-c635-4f21-883c-05c34feea2c9","code":"tabletforeverything","__name":"Таблица для всего","description":"То, чего все ждали.","extensionZoneCode":"","sort":0,"category":"00000000-0000-0000-0000-000000000000","version":18,"hidden":false,"draft":false,"readonly":false,"descriptor":{"icon":"business_portfolio_type_1","template":{"id":"e183e0d3-3a9c-4a0e-8822-14675c3c266e","descriptor":"component","content":{"":[{"id":"59d1bbad-6cb5-440b-b8c3-da674a36948b","descriptor":"dynamic-form-row","values":{"bindingMode":false,"__isConstValues":[],"showDisplayName":true,"control":{"path":["url"]},"tooltip":null,"required":true,"hideEmpty":false,"__readOnly":null}},{"id":"644cbdef-15d2-4fbf-8dfc-77b1de69d3de","descriptor":"dynamic-form-row","values":{"showDisplayName":true,"control":{"path":["authorization"]},"tooltip":null,"required":true,"hideEmpty":false,"__readOnly":null,"bindingMode":false,"__isConstValues":[]}},{"id":"44495549-ddbb-4b8a-9996-e81eaf5b6373","descriptor":"dynamic-form-row","values":{"__isConstValues":[],"showDisplayName":true,"control":{"path":["filter"]},"tooltip":null,"required":true,"hideEmpty":false,"__readOnly":null,"bindingMode":false}},{"id":"7b519581-6f75-4f50-b3f0-6da98841c712","descriptor":"dynamic-form-row","values":{"control":{"path":["fields"]},"tooltip":null,"required":true,"hideEmpty":false,"__readOnly":null,"bindingMode":false,"__isConstValues":[],"showDisplayName":true}},{"id":"3e48208a-210b-4009-8f3b-7f9486bccf83","descriptor":"dynamic-form-row","values":{"bindingMode":false,"__isConstValues":[],"showDisplayName":true,"control":{"path":["id"]},"tooltip":null,"required":false,"hideEmpty":false,"__readOnly":null}},{"id":"56bb86ef-ea0c-4edf-b36b-3d42e6d71b52","descriptor":"dynamic-form-row","values":{"hideEmpty":false,"__readOnly":true,"bindingMode":false,"__isConstValues":[],"showDisplayName":false,"control":{"path":["json"]},"tooltip":null,"required":false}},{"id":"83efa471-892d-4f9e-93a3-2a809d4fbf4f","descriptor":"row","values":{"__isConstValues":[],"__renderContentAsync":false},"content":{"":[{"id":"6ee35f00-99e2-4b35-a594-c69c14187ae1","descriptor":"column","values":{"__styles":"width:90%","__isConstValues":[],"__renderContentAsync":false},"content":{"":[{"id":"10fca7e7-30cf-4dc1-bf68-2b8a69cead7f","descriptor":"code","values":{"html":"\u003cstyle\u003e\n\n.table\n{\n\tdisplay:table;\n}\n\n.tablerow\n{\n\tdisplay:table-row;\n\tmin-height:20px;\n}\n\n.tablecell\n{\n\tdisplay:table-cell;\n\tmin-width:40px;\n}\n\n.scrollable\n{\n\toverflow-x:scroll;\n\toverflow-y:scroll;\n\tmax-width:1200px;\n\tmax-height:calc(1200px/2);\n}\n\n.relative\n{\n\tposition:relative;\n}\n\n.absolute\n{\n\tposition:absolute;\n}\n\n.flex\n{\n\tdisplay:flex;\n}\n\n.hidden\n{\n\tvisibility:hidden;\n}\n\n.stickytop\n{\n\tposition:sticky;\n\ttop:0;\n\tz-index:9999;\n}\n\n.stickyleft\n{\n\tposition:sticky;\n\tleft:0;\n\tz-index:9999;\n}\n\n.nowrap100\n{\n\tdisplay:inline-block;\n\toverflow:hidden;\n\twhite-space:nowrap;\n\twidth:100px;\n}\n\n.bold\n{\n\tfont-weight:800;\n\tcolor:#404048FF;\n}\n\n.backgroundvertical\n{\n\tbackground:linear-gradient(180deg,#44448888 1px,#ffffff00 1px);\n}\n\n.backgroundhorizontal\n{\n\tbackground:linear-gradient(90deg,#44448888 1px,#ffffff00 1px);\n}\n\n.backgroundpassed\n{\n\tbackground:linear-gradient(90deg,#44448888 1px,#44448822 1px);\n}\n\n.foreground\n{\n\tz-index:10000!important;\n}\n\n.popup\n{\n\tposition:absolute;\n\tpadding:10px;\n\tbox-shadow: 2px 2px 6px #000000bb;\n\tbackground:#ffffffff;\n\tz-index:10000;\n}\n\n.employeeload[employeeloadtype=\"red\"]\n{\n\toverflow:hidden;\n\theight:18px;\n\tbackground:linear-gradient(90deg,red 2px,red 2px);\n\tcolor:#000000ff;\n}\n\n\u003c/style\u003e\n\n\u003cdiv class=\"scrollable parent\" id=\"TableForEverything\"\u003e\n\t\u003cdiv class=\"relative table\" id=\"\u003c%-Context.data.id%\u003e\"\u003e\n\t\tТАБЛИЦА ДЛЯ ВСЕГО\n\t\u003c/div\u003e\n\u003c/div\u003e","hideContent":false,"contentPlaceholder":""}}]}},{"id":"7eea876b-db36-492c-85aa-d94bee1b7b3c","descriptor":"column","values":{"__styles":"width:10%","__isConstValues":[],"__renderContentAsync":false},"content":{"":[{"id":"facc89e7-c9c4-40fe-a7bc-54adf4085b08","descriptor":"button","values":{"view":"primary","label":"RequestTableForEverything","action":null,"onClick":{"kind":"Function","name":"RequestTableForEverything","type":"client"},"runInPopover":null,"runActionEnum":[{"code":"undefined","name":"shared.common.button@widget-runAction-none","translate":true}],"__isConstValues":[],"processPopoverSize":[{"code":"default","name":"shared.common.button@widget-process-popover-size-default","translate":true}]}},{"id":"fe86d057-8af6-40fd-885b-f6192727aaae","descriptor":"button","values":{"processPopoverSize":[{"code":"default","name":"shared.common.button@widget-process-popover-size-default","translate":true}],"view":"primary","label":"RenderTableForEverything","action":null,"onClick":{"kind":"Function","name":"RenderTableForEverything","type":"client"},"runInPopover":null,"runActionEnum":[{"code":"undefined","name":"shared.common.button@widget-runAction-none","translate":true}],"__isConstValues":[]}}]}}]}}]}},"fields":[{"code":"url","type":"STRING","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":"https://elma365.tanais.ru/pub/v1/app/umbrella_corp/Mansions/list","calcByFormula":false,"formula":"","data":{},"view":{"name":"Путь для запроса элементов приложения","tooltip":"Полное описание запроса можно найти в приложении, выбрав пункт API.","data":{"additionalType":"string"}}},{"code":"authorization","type":"STRING","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":"b7945837-23c9-472f-98f3-d8004d917670","calcByFormula":false,"formula":"","data":{},"view":{"name":"Токен авторизации","tooltip":"Токен авторизации можно посмотреть в разделе администрирование, выбрав пункт Токены.","data":{"additionalType":"string"}}},{"code":"filter","type":"STRING","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":"{\n    \"or\":[\n        {\n            \"eq\":[\n                {\"field\": \"__index\"},\n                {\"const\":1}\n            ]\n        },\n        {\n            \"like\":[\n                {\"field\": \"__name\"},\n                {\"const\": \"Раккун-Сити\"}\n            ]\n        }\n    ]\n}","calcByFormula":false,"formula":"","data":{},"view":{"name":"Текст условия","tooltip":"Полное описание фильтра можно найти здесь. https://api.elma365.com/ru/public-api/guides/Filter/","data":{"additionalType":"text"}}},{"code":"fields","type":"STRING","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":"{\n    \"__name\":true,\n    \"__createdAt\":true,\n    \"__createdBy\":true,\n    \"__index\":true,\n    \"__updatedAt\":true,\n    \"__updatedBy\":true\n}","calcByFormula":false,"formula":"","data":{},"view":{"name":"Список полей для отображения","tooltip":"Полного описания полей еще нет.","data":{"additionalType":"text"}}},{"code":"id","type":"STRING","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":"Mansions","calcByFormula":false,"formula":"","data":{},"view":{"name":"Идентификатор","tooltip":"У разных таблиц на одной странице должны быть разные идентификаторы.","data":{"additionalType":"string"}}},{"code":"json","type":"JSON","searchable":false,"indexed":false,"deleted":false,"array":false,"required":false,"single":true,"defaultValue":null,"calcByFormula":false,"formula":"","data":{},"view":{"name":"Json","data":{}}}],"fieldVisibilityConditions":{"id":{"enabled":false,"conditions":[]},"App":{"enabled":false,"conditions":[]},"app":{"enabled":false,"conditions":[]},"url":{"enabled":false,"conditions":[]},"Code":{"enabled":false,"conditions":[]},"Name":{"enabled":false,"conditions":[]},"code":{"enabled":false,"conditions":[]},"json":{"enabled":false,"conditions":[]},"Query":{"enabled":false,"conditions":[]},"Fields":{"enabled":false,"conditions":[]},"Filter":{"enabled":false,"conditions":[]},"fields":{"enabled":false,"conditions":[]},"filter":{"enabled":false,"conditions":[]},"__hidden":{"enabled":false,"conditions":[]},"__styles":{"enabled":false,"conditions":[]},"Namespace":{"enabled":false,"conditions":[]},"__classes":{"enabled":false,"conditions":[]},"gsdfsgsdf":{"enabled":false,"conditions":[]},"namespace":{"enabled":false,"conditions":[]},"__readOnly":{"enabled":false,"conditions":[]},"Application":{"enabled":false,"conditions":[]},"application":{"enabled":false,"conditions":[]},"authorization":{"enabled":false,"conditions":[]},"__onMouseEnter":{"enabled":false,"conditions":[]},"__onMouseLeave":{"enabled":false,"conditions":[]},"__isConstValues":{"enabled":false,"conditions":[]},"TypeOfApplication":{"enabled":false,"conditions":[]},"__renderContentAsync":{"enabled":false,"conditions":[]},"api_namespaceapplication":{"enabled":false,"conditions":[]}},"scriptOptions":{"allowNamespace":true},"clientScripts":"//Client scripts module\n\ndeclare const console:any;\n//@ts-ignore\nconsole.clear();\ndeclare const document:any;\n\nasync function onInit (): Promise\u003cvoid\u003e\n{\n}\n\nasync function RequestTableForEverything (): Promise\u003cvoid\u003e\n{\n    const response = await fetch(Context.data.url+'',{\n            method:'POST',\n            headers:{ Authorization:`Bearer ${Context.data.authorization}` },\n            body:`{\n                    \"active\":true,\n                    \"size\":100,\n                    \"from\":0,\n                    \"filter\":${decodeURIComponent(Context.data.filter+'')},\n                    \"fields\":${decodeURIComponent(Context.data.fields+'')},\n                    \"sortExpressions\":[\n                        {\n                            \"field\":\"__createdAt\",\n                            \"ascending\":true\n                        }\n                    ]\n                }`\n        });\n    Context.data.json = await response.json();\n    if (Context.data.json.success == false)\n        throw new Error(Context.data.json.error);\nconsole.log(Context.data.json);\n}\n\nasync function RenderTableForEverything (): Promise\u003cvoid\u003e\n{\n    if (Context.data.fields == null)\n        return;\n    const fields = Context.data.fields.match(/(?\u003c=\")[0-z]+(?=\": *true)/gm);\n    if (fields == null)\n        return;\n    const table = document.querySelector(\"#TableForEverything\u003e.table#\"+Context.data.id);\n          table.innerHTML = \"\";\n    {\n        const row = table.appendChild(document.createElement(\"div\"));\n              row.className = \"stickytop backgroundvertical tablerow\";\n        for (var j = 0; j \u003c fields.length; j++)\n        {\n            const cell = row.appendChild(document.createElement(\"div\"));\n                  cell.className = (j==0?\"stickyleft \":\"\")+\"backgroundhorizontal tablecell bold\";\n                  cell.textContent = fields[j];\n        }\n    }\n    for (var i = 0; i \u003c Context.data.json.result.result.length; i++)\n    {\n        const row = table.appendChild(document.createElement(\"div\"));\n              row.className = \"backgroundvertical tablerow\";\n        const element = Context.data.json.result.result[i];\n        for (j = 0; j \u003c fields.length; j++)\n        {\n            const cell = row.appendChild(document.createElement(\"div\"));\n                  cell.className = (j==0?\"stickyleft \":\"\")+\"backgroundhorizontal tablecell\";\n                  cell.textContent = element[fields[j]];\n        }\n    }\n}","clientScriptOptions":{"allowNamespace":true,"allowServer":true},"serverScripts":"/* Server scripts module */\n","serverScriptOptions":{"allowNamespace":true}},"dataNamespace":"","dataCode":"","runtime":{"version":1,"clientScripts":"System.register([], function (exports_1, context_1) {\n    \"use strict\";\n    var __moduleName = context_1 \u0026\u0026 context_1.id;\n    function default_1(Context, ViewContext, Server) {\n        console.clear();\n        async function onInit() {\n        }\n        async function RequestTableForEverything() {\n            const response = await fetch(Context.data.url + '', {\n                method: 'POST',\n                headers: { Authorization: `Bearer ${Context.data.authorization}` },\n                body: `{\n                    \"active\":true,\n                    \"size\":100,\n                    \"from\":0,\n                    \"filter\":${decodeURIComponent(Context.data.filter + '')},\n                    \"fields\":${decodeURIComponent(Context.data.fields + '')},\n                    \"sortExpressions\":[\n                        {\n                            \"field\":\"__createdAt\",\n                            \"ascending\":true\n                        }\n                    ]\n                }`\n            });\n            Context.data.json = await response.json();\n            if (Context.data.json.success == false)\n                throw new Error(Context.data.json.error);\n            console.log(Context.data.json);\n        }\n        async function RenderTableForEverything() {\n            if (Context.data.fields == null)\n                return;\n            const fields = Context.data.fields.match(/(?\u003c=\")[0-z]+(?=\": *true)/gm);\n            if (fields == null)\n                return;\n            const table = document.querySelector(\"#TableForEverything\u003e.table#\" + Context.data.id);\n            table.innerHTML = \"\";\n            {\n                const row = table.appendChild(document.createElement(\"div\"));\n                row.className = \"stickytop backgroundvertical tablerow\";\n                for (var j = 0; j \u003c fields.length; j++) {\n                    const cell = row.appendChild(document.createElement(\"div\"));\n                    cell.className = (j == 0 ? \"stickyleft \" : \"\") + \"backgroundhorizontal tablecell bold\";\n                    cell.textContent = fields[j];\n                }\n            }\n            for (var i = 0; i \u003c Context.data.json.result.result.length; i++) {\n                const row = table.appendChild(document.createElement(\"div\"));\n                row.className = \"backgroundvertical tablerow\";\n                const element = Context.data.json.result.result[i];\n                for (j = 0; j \u003c fields.length; j++) {\n                    const cell = row.appendChild(document.createElement(\"div\"));\n                    cell.className = (j == 0 ? \"stickyleft \" : \"\") + \"backgroundhorizontal tablecell\";\n                    cell.textContent = element[fields[j]];\n                }\n            }\n        }\n        return {\n            onInit,\n            RequestTableForEverything,\n            RenderTableForEverything\n        };\n    }\n    exports_1(\"default\", default_1);\n    return {\n        setters: [],\n        execute: function () {\n        }\n    };\n});\n","clientFnDeclarations":[{"name":"onInit","parameters":[],"type":"[object Object]"},{"name":"RequestTableForEverything","parameters":[],"type":"[object Object]"},{"name":"RenderTableForEverything","parameters":[],"type":"[object Object]"}]},"__createdAt":"2023-08-03T14:56:34.712200466Z","__createdBy":"bc5f25d2-e599-4041-9764-37ebcd11a678","__updatedAt":"2023-08-24T12:30:01.130310013Z","__updatedBy":"bc5f25d2-e599-4041-9764-37ebcd11a678","__deletedAt":null}
